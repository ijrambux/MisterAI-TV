<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>MisterAI Cinema</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0a0a0a; color: white; font-family: sans-serif; }
        .poster-card { transition: 0.3s; cursor: pointer; position: relative; }
        .poster-card:hover { transform: scale(1.05); }
        .poster-img { aspect-ratio: 2/3; object-fit: cover; border-radius: 12px; border: 1px solid #222; }
        .loading { border: 4px solid #f3f3f3; border-top: 4px solid #e50914; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <nav class="p-6 flex justify-between items-center bg-black/80 sticky top-0 z-50 backdrop-blur-md">
        <h1 class="text-2xl font-black text-red-600 tracking-tighter">MisterAI <span class="text-white">PRO</span></h1>
        <div class="flex gap-2">
            <button onclick="loadData('get_vod_streams')" class="bg-red-600 hover:bg-red-700 px-6 py-2 rounded-full font-bold transition">أفلام</button>
            <button onclick="loadData('get_series')" class="bg-zinc-800 hover:bg-zinc-700 px-6 py-2 rounded-full font-bold transition">مسلسلات</button>
            <button onclick="loadData('get_live_streams')" class="bg-zinc-800 hover:bg-zinc-700 px-6 py-2 rounded-full font-bold transition">قنوات</button>
        </div>
    </nav>

    <div id="loader" class="hidden flex justify-center mt-20"><div class="loading"></div></div>
    
    <div id="grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6 p-8">
        </div>

    <script>
        async function loadData(actionType) {
            const grid = document.getElementById('grid');
            const loader = document.getElementById('loader');
            
            grid.innerHTML = '';
            loader.classList.remove('hidden');

            try {
                const res = await fetch(`/api/content?type=${actionType}`);
                const data = await res.json();
                
                data.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'poster-card';
                    
                    // استخراج الصورة والاسم حسب نوع الـ API
                    const title = item.name || item.title;
                    const img = item.stream_icon || item.last_modified || 'https://via.placeholder.com/300x450?text=No+Poster';

                    card.innerHTML = `
                        <img src="${img}" class="poster-img w-full shadow-2xl" onerror="this.src='https://via.placeholder.com/300x450?text=${title}'">
                        <h3 class="mt-3 text-sm font-semibold truncate text-center text-zinc-300 px-2">${title}</h3>
                    `;
                    grid.appendChild(card);
                });
            } catch (e) {
                console.error("خطأ في التحميل");
            } finally {
                loader.classList.add('hidden');
            }
        }

        // تحميل الأفلام تلقائياً عند البدء
        loadData('get_vod_streams');
    </script>
</body>
</html>
